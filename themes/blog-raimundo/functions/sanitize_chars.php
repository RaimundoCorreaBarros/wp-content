<?php 

/**
 * Sanitize Characters
 * Replaces all special characters when a file is loaded as media
 *
 * @return  void
 * @since   1.0
 */
function dl_sanitize_chars( $filename ) {

	$original_chars = array(
		'/А/','/Б/','/В/','/Г/',
		'/Д/','/Е/','/Ж/','/З/','/И/',
		'/Й/','/К/','/Л/','/М/','/Н/',
		'/О/','/П/','/Р/','/С/','/Т/',
		'/У/','/Ф/','/Х/','/Ц/','/Ч/',
		'/Ш/','/Щ/','/Ь/','/Ю/','/Я/',
		'/а/','/б/','/в/','/г/','/д/','/е/','/ж/',
		'/з/','/и/','/й/','/к/','/л/',
		'/м/','/н/','/о/','/п/','/р/',
		'/с/','/т/','/у/','/ф/','/х/',
		'/ц/','/ч/','/ш/','/щ/',
		'/ь/','/ю/','/я/',
		'/Ґ/','/ґ/','/Є/','/є/','/І/','/і/','/Ї/','/ї/',
		'/Ё/','/ё/','/Ы/','/ы/','/Ъ/','/ъ/','/Э/','/э/',
		'/Ў/','/ў/',
		'/Ä/','/ä/','/Ö/','/ö/','/Ü/','/ü/','/ß/',
		'/Ą/','/ą/','/Ć/','/ć/','/Ę/','/ę/','/Ł/','/ł/','/Ń/','/ń/','/Ó/','/ó/','/Ś/','/ś/','/Ź/','/ź/','/Ż/','/ż/',
		'/Ő/','/ő/','/Ű/','/ű/',
		'/ě/','/š/','/č/','/ř/','/ž/','/ý/','/á/','/é/','/ď/','/ť/','/ň/','/ú/','/ů/',
		'/Ě/','/Š/','/Č/','/Ř/','/Ž/','/Ý/','/Á/','/É/','/Ď/','/Ť/','/Ň/','/Ú/','/Ů/',
		'/א/','/ב/','/ג/','/ד/','/ה/','/ו/','/ז/','/ח/','/ט/','/י/','/ך/','/כ/','/ל/','/ם/','/מ/','/ן/','/נ/','/ס/','/ע/','/ף/','/פ/','/ץ/','/צ/','/ק/','/ר/','/ש/','/ת/',
		'/À/','/Á/','/Â/','/Ã/','/Å/','/Æ/','/Ç/','/È/','/É/','/Ê/','/Ë/','/Ì/','/Í/','/Î/','/Ï/','/Ð/','/Ñ/','/Ò/','/Ô/','/Õ/','/×/','/Ø/','/Ù/','/Ú/','/Û/','/Ý/','/Þ/',
		'/à/','/á/','/â/','/ã/','/å/','/æ/','/ç/','/è/','/é/','/ê/','/ë/','/ì/','/í/','/î/','/ï/','/ð/','/ñ/','/ò/','/ô/','/õ/','/×/','/ø/','/ù/','/ú/','/û/','/ý/','/þ/','/ÿ/','/Ÿ/',
		'/№/','/“/','/”/','/«/','/»/','/„/','/@/','/%/',
		'/‘/','/’/','/`/','/´/','/º/','/ª/','/[\s\+]/','/\.(?=.*\.)/'
	);

	$sanitized_chars = array(
		'a','b','v','h',
		'd','e','zh','z','y',
		'j','k','l','m','n',
		'o','p','r','s','t',
		'u','f','h','c','ch',
		'sh','shh','','ju','ja',
		'a','b','v','h','d','e','zh',
		'z','y','j','k','l',
		'm','n','o','p','r',
		's','t','u','f','h',
		'c','ch','sh','sch',
		'','ju','ja',
		'g','g','je','je','i','i','ji','ji',
		'jo','jo','y','y','','','ye','ye',
		'u','u',
		'ae','ae','oe','oe','ue','ue','ss',
		'a','a','c','c','e','e','l','l','n','n','o','o','s','s','z','z','z','z',
		'o','o','u','u',
		'e','s','c','r','z','y','a','e','d','t','n','u','u',
		'e','s','c','r','z','y','a','e','d','t','n','u','u',
		'a','b','g','d','h','v','z','h','t','y','f','k','l','f','m','f','n','s','a','f','p','f','t','q','r','s','t',
		'a','a','a','a','a','ae','c','e','e','e','e','i','i','i','i','d','n','o','o','o','x','o','u','u','u','y','p',
		'a','a','a','a','a','ae','c','e','e','e','e','i','i','i','i','d','n','o','o','o','x','o','u','u','u','y','p','y','y',
		'','','','','','','','',
		'','','','','o','a','-','-'
	);

	$friendly_filename = preg_replace( $original_chars, $sanitized_chars, $filename );
	$friendly_filename = preg_replace( '/[^a-zA-Z0-9_\.-]/', '', $friendly_filename );
	
	return $friendly_filename;

}

add_filter( 'sanitize_file_name', 'dl_sanitize_chars', 10 );
